[
["index.html", "PrAnaViz 1 Introduction", " PrAnaViz Kishore Jagadeesan 2020-07-17 1 Introduction During the last decade, wide range of active pharmaceutical ingredients (APIs) have been identified and quantified in aquatic environment across several studies and indicated their impacts on exposed environmental species and humans. For the prediction of total amount of the APIs released to the environment, information about APIs consumption data is vital. Globally, several methods were reported to estimate the APIs consumption data based on the national prescription data, manufacturers, importers and dispenser’s data. In the UK, national prescription data provided by National Health Service (NHS), was used to calculate the consumption data. This data is freely accessible and consist of individual files for each month. With the large file with over 10 million records every month, the data from the NHS cannot be used for the direct calculation of the prescription levels of different APIs. Re-organisation and processing of the files is required before to do any exploration or analysis and to speed up the data reading. The aim of PrAna is to aggregate and normalize prescription data to calculate total prescribed quantity of different APIs, using open source statistical software R language. The name is an acronym for Prescription Analysis Apart, from the calculation of the total prescribed quantity of an API or a group of APIs, specified to a postcode or region, We have also developed, an open interactive web-based tool, PrAnaViz with the processed dataset for the period 2015 to 2018. PrAnaViz facilitates users to visualise, explore and report different spatiotemporal and long-term prescription trends for wider use. The documentation of PrAna consists of three parts: This handbook The reference manual (accessible in R with ?PrAna-package or online here) A tutorial for PrAnaViz (accessible at here) "],
["install.html", "2 Installation 2.1 Dependencies", " 2 Installation PrAna can be installed as any other R package, however, since it is dependent on some other software tools some extra steps are required for the installation. You can install the development version of PrAna from GitHub with: # install.packages(&quot;devtools&quot;) library(devtools) install_github(&quot;jkkishore85/PrAna&quot;) Note that you will need to have the latest R version installed in order to use this repository. 2.1 Dependencies Software Remarks RStudio Suggested IDE platform to perform the R operations MySQL Optional to host the generated dataset "],
["workflow.html", "3 Workflow 3.1 Data Preparation 3.2 Data Conversion 3.3 Visualise and Analyse the data 3.4 Database service 3.5 Download images and processed data", " 3 Workflow The workflow in this tutorial consists of the following steps, as in the Figure: 3.1: Data Preparation: Download monthly NHS prescription datasets and Dictionary of medicines and devices release files (dm+d). Data Conversion: Aggregation and conversion of the locally stored datasets into practice wise dataset achieved using the functions in PrAna. Visualise and Analyse the data: Visualise and analyse the processed dataset using the in-built ShinyApp PrAnaViz. Database service: Linking of the processed dataset to the PrAnaViz can be achieved by uploading the processed dataset to a local or a remote database service, for example, MySQL. Download images and processed data: Users can download processed data as .csv file and publication ready image .eps and .pdf files. Figure 3.1: PrAna Workflow. 3.1 Data Preparation Data sources Prescribing data and Practice information are from the monthly files published by the NHS Business Service Authority, used under the terms of the Open Government Licence. BNF codes and names are also from the [NHS Business Service Authority’s Information Portal] NHSBSA, used under the terms of the Open Government Licence. dm+d weekly release data is also from the NHS Business Service Authority’s Information Portal, used under the terms of the Open Government Licence. To download NHS prescription datasets, users need to guest login and solve a captcha in NHSBSA information portal, to download the dm+d release files and dm+d XML Transformation Tool, users need to register an account. Store the monthly NHS prescription data in year wise folder. For an example, store all the 2015 monthly datasets in a folder named ‘2015’. Extract the dm+d release files using dm+d XML Transformation Tool. The documentation to extract the release file using the tool is well explained in the readme file. 3.2 Data Conversion Different functions were used in the aggregation and conversion workflow behind the scenes that performs the heavy lifting of a workflow step and finally return the results. An overview of all functions involved in the data conversion is shown in the table below. Function Remarks csv2dat() Combine and convert all the comma separated value (.CSV) files in the defined file path and export it into a single R object importdmd() Import dm+d files and link it to the BNF code using the SNOMED mapping file practice_wise() Import NHS dataset files and generate processed individual GP practice prescription dataset runShiny() Run in-built Shiny Apps in the package 3.2.1 Combine NHS monthly dataset csv2dat() function supports to combine different monthly NHS prescription dataset files into a single data.frame to process further. For an example: ## Load library library(PrAna) ## Set the folder to store the combined file setwd(&quot;C:/Datasets/2018&quot;) ## Combine and convert mulitple files in the defined folder to a dataframe data201812 &lt;- csv2dat(&quot;C:/Datasets/Prescription Datasets/2018/PDPI&quot;) 3.2.2 Import dm+d files importdmd() function helps to import different extracted [dm+d files] [#dataextraction] and return multiple data objects including a data.frame which map each BNF code to its corresponding API(s), strength and medicinal form. Recommended to read the documentation of importdmd() function to know more regarding the different data objects it generate. ## Read the extracted dm+d files dmdfile &lt;- importdmd(&quot;C:/dmdDataLoader/excel/&quot;) 3.2.3 Generate GP practice wise file The final step in the data conversion is to generate prescription dataset mapped with the individual API, prescription quantity, medicinal form, and strength for the defined GP practice(s), practice_wise() is used to carry out this conversion. And before execute the practice_wise() function it is strongly suggested to setup the destination folder as the working directory using setwd() function. The practice_wise() function require following six parameters, as mentioned in the example below, Combined NHS prescription dataset, genereated using csv2dat() function A character vector containing GP Practices A data.frame containing BNF Code mapped to individial APIs, strength, medicinal form Unit of measurement with multiplication factors file Different medicinal forms with its corresponding codes file Different APIs with its corresponding codes file ## create a data.frame object for the BNF code mapping file api_map &lt;- dmdfile$api_map ## Unit of measurements uom &lt;- dmdfile$uomwdesc %&gt;% dplyr::rename(UOM = CD) ## Medicinal form dform &lt;- dmdfile$dform ## ingredients list ing &lt;- dmdfile$ing %&gt;% dplyr::rename(API_CODE = 1) ## Define the output location setwd(&quot;C:/Datasets/Prescription Datasets/practice_wise/2018&quot;) ## Execute practice_wise() function practice_wise(data201812, GP_practices, api_map, uom, dform, ing) 3.3 Visualise and Analyse the data GP practice level files generated using the practice_wise() function are used to calculate the total prescribed quantity of different APIs at the particular GP practices and at a particular postcode using the in-built ShinyApp PrAnaViz. PrAnaViz helps to visualise the total prescribed quantity of different APIs and to explore spatiotemporal trends of different APIs. For a very quick start to PrAnaViz: library(PrAna) runShiny(&quot;PrAnaViz&quot;) The runShiny(\"PrAnaViz\") function will pop-up the PrAnaViz tool which will allow you to explore different spatiotemporal and long-term prescription trends with the sample dataset. However, for a better guide to get started it is recommended to see the Section 4. 3.4 Database service To avoid the large data loading and processing issue, authors strongly suggest to upload the processed dataset to a local or a remote database service, for example, MySQL, and link it to the PrAnaViz. More information on the linking databases to PrAnaViz is explained in the Section 4. 3.5 Download images and processed data Users can download processed data as .csv file and publication ready image .eps and .pdf files, for their further usage and applications. "],
["pranaviz.html", "4 PrAnaViz 4.1 Introduction 4.2 Targeted Approach 4.3 Non-targeted Approach", " 4 PrAnaViz 4.1 Introduction The aim of this tool is to visualise and analyse the prescription data to calculate total prescribed quantity of different APIs and to explore spatiotemporal trends of different APIs for wider use. We have created, PrAnaViz, in a familiar dashboard layout with two tabs: (1) Targeted API, (2) Non-targeted API, to visualize total quantity of different APIs at CCG region with resolution to individual postcode. 4.2 Targeted Approach In this tab, user can input a list of APIs, and find out the total prescription quantity of each API in the selected year, at the selected CCG region, as in the Figure: 4.1. This tab also visualise the total quantity of APIs prescribed by month, GP, Chemical form, and Medicinal form for a CCG region in a selected year. Figure 4.1: PrAna Targeted Approach. Option Remarks 1 Select Targeted or Non-Targeted Approach 2 Select Year, Region and Setting Type 3 Upload targets i.e., APIs in .csv format 4 Select monthwise or yearwise plots 5 Plot generated based on user selection 6 Download buttons to download the generated plot as .pdf or .eps and data as .csv format 7 More insights on a selected API, visualise total prescribed quantity of the API per month, GP practice, postcode and medicinal form (click on a particular API on the barplot to generate these plots) 8 Download buttons to download the generated plot as .pdf or .eps and data as .csv format 4.3 Non-targeted Approach Total prescription quantity of an individual API at different postcode per month at a CCG region, can be rendered in this tab, as in the Figure: 4.2. The calculated total prescription quantity of an individual API at postcode level helps to find the hotspots. User can download data as .csv file and publication ready image .eps and .pdf files. Figure 4.2: PrAna Non-targeted Approach. Option Remarks 1 Select Targeted or Non-Targeted Approach 2 Select Year, Region and Setting Type 3 Select API in the drop-down menu 4 Select a month 5 Plot generated based on user selection, click on a particular postcode to generate further plots 6 Download buttons to download the generated plot as an interactive .html document and data as .csv format 7 Visualise total prescribed quantity of the API per month on the selected postcode (click on a particular postoode on the plot to generate these plots) 8 Download buttons to download the generated plot as .pdf or .eps and data as .csv format 9 Visualise total prescribed quantity of the API per medicinal form on the selected postcode "],
["acknowledgements.html", "5 Acknowledgements", " 5 Acknowledgements This package was built as a part of the Wastewater Fingerprinting for Public Health Assessment (ENTRUST) project funded by Wessex Water and EPSRC IAA (grant no. EP/R51164X/1). "],
["disclaimer.html", "6 Disclaimer", " 6 Disclaimer We accept no liability for any errors in the data or its publication here: use this data at your own risk. You should not use this data to make individual prescribing decisions. "]
]
